name: Launch GUI App via Task Scheduler

on:
  workflow_dispatch:

jobs:
  launch-gui:
    runs-on: [self-hosted, windows, gui]
    defaults:
      run:
        shell: powershell

    steps:
      - name: Lanzar tarea LanzarAppGUI
        run: |
          Write-Host "[INFO] Configurando trigger…"
          $t = New-ScheduledTaskTrigger -Once -At ((Get-Date).AddSeconds(5))
          Set-ScheduledTask -TaskName "LanzarAppGUI" -Trigger $t

          Write-Host "[INFO] Disparando LanzarAppGUI…"
          Start-ScheduledTask -TaskName "LanzarAppGUI"

          Write-Host "[INFO] Workflow terminado. La app GUI sigue corriendo."
