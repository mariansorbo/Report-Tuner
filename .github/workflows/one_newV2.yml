name: Ejecutar One_new.py directo

on:
  workflow_dispatch:

jobs:
  run-one-new:
    runs-on: [self-hosted, windows, gui]
    defaults: { run: { shell: powershell } }

    steps:
      - name: Apuntar tarea a One_new.py
        run: |
          $action = New-ScheduledTaskAction -Execute 'python' -Argument 'C:\Users\Mariano\Documents\DMV Automation - 10 Jun V2\One_new.py'
          Set-ScheduledTask -TaskName "LanzarAppGUI" -Action $action

      - name: Disparar LanzarAppGUI
        run: |
          $t = New-ScheduledTaskTrigger -Once -At ((Get-Date).AddSeconds(5))
          Set-ScheduledTask -TaskName "LanzarAppGUI" -Trigger $t
          Start-ScheduledTask -TaskName "LanzarAppGUI"
          Write-Host "LanzarAppGUI ejecutando One_new.py"
